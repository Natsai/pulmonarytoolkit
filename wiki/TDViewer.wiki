#summary A Matlab application for viewing 2D and 3D medical imaging data


= TDViewer =

TDViewer is a standalone application for visualising 3D or 2D data slice-by-slice. 

= Requirements = 
 * A recent version of Matlab
 * TD Pulmonary Toolkit


= Features =

 * View images slice-by-slice in coronal, sagittal or axial directions
 * Overlay image with adjustable transparency
 * Quiver plot overlay
 * Zoom and Pan tools 
 * Change window and level through scrollbars or editable text boxes
 * Cine using mouse wheel, scrollbar or draggable cine tool
 * Marker mode to interactively add, remove and edit marker points in multiple colours
 * Supports non-uniform image resolutions
 * Displays current voxel coordinates, image value and Hounsfield value (for C images)

= Running TDViewer =

Before running the TDViewer, you may first need to add the PTK paths
{{{
    TDAddPtkPaths;
}}}

To visualise a 3D volume contained in the matrix my_image, run:
{{{
    TDViewer(my_image);
}}}
`my_image` can also be a TDImage or TDDicomImage class. This is preferable, because then TDViewer will respect the voxel size and automatically display a title based on the patient name.


You can specify an image type to control how the image is displayed:
{{{
    TDViewer(my_image, image_type);
}}}
Possible values of image_type are:

 * `TDImageType.Grayscale` - visualise a greyscale image (use for CT and MRI data)
 * `TDImageType.Colormap`  - visualise using the Lines colourmap. Each voxel represents a colour, e.g. 1 = blue, 2 = green, 3 = red etc.
 * `TDImageType.Scaled`       - visualise in shades of red (positive values) or blue (negative values), scaling the image so that the smallest value is black and the highest value is red.

To view data from DICOM files, load them into a TDImage and then display this:
{{{
    dicom_image = TDLoadImageFromDicomFiles(path, filenames);
    TDViewer(dicom_image);
}}}
A similar approach applies to mhd/raw files:
{{{
    my_image = TDLoad3DRawAndMetaFiles(path, filenames, uid);
    TDViewer(my_image);
}}}
Note you must specify an image uid, because this is not specified in the metaheader.

= Controls =
 * The `Cor` (Coronal), `Sag` (sagittal) and `Ax` (Axial) buttons control which direction you are viewing the images in
 * The `Image` checkbox toggles display of the background image
 * The `Overlay` checkbox toggles display of the overlay image. Move the slider to change the transparency of the overlay
 * `Window` and `Level` controls can be adjusted using sliders or editable text boxes

 = Keyboard and mouse shortcuts =
 * `C` - coronal mode
 * `S` - sagittal mode
 * `A` - axial mode
 * `Z` - zoom mode
 * `P` - pan mode
 * `E` - cine mode (drag to cine)
 * `M` - marker mode
 * `I` - toggle image on/off
 * `O` - toggle overlay on/off
 * `T` - toggle whether black in an overlay image is transparent
 * `SHIFT+mouse drag` - pan (in any mode)
 * `CTRL+mouse drag` - zoom (in any mode)
 * `Down Arrow` - next slice
 * `Up Arrow` - next slice
 * `mouse scrollwheel / trackpad` - cine through images

== Marker mode shortcuts ==
 * `L` - Toggle marker labels on/off (marker mode)
 * `1`,` 2`, `3`, `4`,` 5`, `6`, `7` - change colour of next marker to place
 * `Backspace` - delete the marker the mouse is currently over
 * `Space` - Cine to the nearest image slice containing a marker 
 * `Right Arrow` - Cine forward 10 slices, but stop at a slice if it contains a marker
 * `Left Arrow` - Cine back 10 slices, but stop at a slice if it contains a marker
 * `Right Arrow` - Cine forward 10 slices, but stop at a slice if it contains a marker
 * `Page Up` - Cine to the first slice in the image containing a marker, or to the beginning of the image if the current slice contains the first marker
 * `Page Down` - Cine to the last slice in the image containing a marker, or to the end of the image if the current slice contains the last marker